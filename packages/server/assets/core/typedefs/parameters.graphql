"""
Base parameter interface with common fields
"""
interface BaseParameter {
  id: ID!
  name: String!
  field: String!
  visible: Boolean!
  header: String!
  description: String
  category: String
  order: Int
  computed: JSONObject
  source: String
  removable: Boolean!
  value: String! # Always string in GraphQL
  metadata: JSONObject
}

"""
BIM parameter type
"""
type BimParameter implements BaseParameter {
  id: ID!
  kind: String! # Always 'bim'
  name: String!
  type: BimValueType!
  sourceValue: String! # BIM value as string
  fetchedGroup: String!
  currentGroup: String!
  field: String!
  visible: Boolean!
  header: String!
  description: String
  category: String
  order: Int
  computed: JSONObject
  source: String
  removable: Boolean!
  value: String!
  metadata: JSONObject
}

"""
User parameter type
"""
type UserParameter implements BaseParameter {
  id: ID!
  kind: String! # Always 'user'
  name: String!
  type: UserValueType!
  group: String!
  equation: String
  isCustom: Boolean
  field: String!
  visible: Boolean!
  header: String!
  description: String
  category: String
  order: Int
  computed: JSONObject
  source: String
  removable: Boolean!
  value: String!
  metadata: JSONObject
}

"""
Union of all parameter types
"""
union Parameter = BimParameter | UserParameter

"""
BIM value type enum
"""
enum BimValueType {
  string
  number
  boolean
  date
  object
  array
}

"""
User value type enum
"""
enum UserValueType {
  fixed
  equation
}

"""
Input for creating a BIM parameter
"""
input CreateBimParameterInput {
  name: String!
  type: BimValueType!
  sourceValue: String!
  fetchedGroup: String!
  currentGroup: String!
  field: String!
  visible: Boolean!
  header: String!
  description: String
  category: String
  order: Int
  source: String
  removable: Boolean!
  value: String!
  metadata: JSONObject
}

"""
Input for creating a user parameter
"""
input CreateUserParameterInput {
  name: String!
  type: UserValueType!
  group: String!
  equation: String
  isCustom: Boolean
  field: String!
  visible: Boolean!
  header: String!
  description: String
  category: String
  order: Int
  source: String
  removable: Boolean!
  value: String!
  metadata: JSONObject
}

"""
Input for updating a BIM parameter
"""
input UpdateBimParameterInput {
  name: String
  type: BimValueType
  sourceValue: String
  currentGroup: String
  field: String
  visible: Boolean
  header: String
  description: String
  category: String
  order: Int
  source: String
  removable: Boolean
  value: String
  metadata: JSONObject
}

"""
Input for updating a user parameter
"""
input UpdateUserParameterInput {
  name: String
  type: UserValueType
  group: String
  equation: String
  isCustom: Boolean
  field: String
  visible: Boolean
  header: String
  description: String
  category: String
  order: Int
  source: String
  removable: Boolean
  value: String
  metadata: JSONObject
}

"""
Response type for parameter mutations
"""
type ParameterMutationResponse {
  parameter: Parameter!
}

extend type Query {
  """
  Get all parameters for the current user
  """
  parameters: [Parameter!]!

  """
  Get a specific parameter by ID
  """
  parameter(id: ID!): Parameter

  """
  Get all parameters for a specific table
  """
  tableParameters(tableId: ID!): [Parameter!]!
}

extend type Mutation {
  """
  Create a new BIM parameter
  """
  createBimParameter(input: CreateBimParameterInput!): ParameterMutationResponse!

  """
  Create a new user parameter
  """
  createUserParameter(input: CreateUserParameterInput!): ParameterMutationResponse!

  """
  Update a BIM parameter
  """
  updateBimParameter(
    id: ID!
    input: UpdateBimParameterInput!
  ): ParameterMutationResponse!

  """
  Update a user parameter
  """
  updateUserParameter(
    id: ID!
    input: UpdateUserParameterInput!
  ): ParameterMutationResponse!

  """
  Delete a parameter
  """
  deleteParameter(id: ID!): Boolean!

  """
  Add a parameter to a table (updates mapping)
  """
  addParameterToTable(parameterId: ID!, tableId: ID!): Boolean!

  """
  Remove a parameter from a table (updates mapping)
  """
  removeParameterFromTable(parameterId: ID!, tableId: ID!): Boolean!
}
